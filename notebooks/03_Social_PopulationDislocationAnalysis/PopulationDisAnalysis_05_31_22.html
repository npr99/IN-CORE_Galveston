
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Galveston Island Population Dislocation Analysis &#8212; Galveston Notebook Gallery</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Galveston Island Damage Model: Roadways" href="../01_Damage_Transportation_Roadways/RoadwaysDamage_05_18_22.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/log.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Galveston Notebook Gallery</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Galveston Notebook Gallery
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Galveston_testbed_2022-09-19.html">
   Galveston Testbed
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Building
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Buildings/BuildingDamage_Tori_05_18_22.html">
   Galveston Island Damage Model: BUILDING
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Power
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Electric%20Power/WoodPolesDamage_05_23_22.html">
   Galveston Island Damage Model: WOOD POLES
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Electric%20Power_Prestressed%20poles/PrestressedPolesDamage_05_23_22.html">
   Galveston Island Damage Model: PRESTRESSED POLES
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Electric%20Power_Substations/SubstationDamage_05_23_22.html">
   Galveston Island Damage Model: SUBSTATIONS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Electric%20Power_Towers/TowerDamage_05_23_22.html">
   Galveston Island Damage Model: TOWERS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Electric%20Power_WoodPoles/WoodPolesDamage_05_23_22.html">
   Galveston Island Damage Model: WOOD POLES
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_Damage_EPNAnalysis/EPN_NetworkAnalysis_05_23_22.html">
   Galveston Island Damage Model: EPN NETWORK ANALYSIS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_AdditionalNotebooks/Nearest%20neighbor%20analysis_Poles%20and%20Buildings/PolesBldgsNearestNeighbor_05_23_22.html">
   Galveston Island Damage Model: EPN NETWORK ANALYSIS
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Transportation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Transportation_Bridges/BridgesDamage_05_18_22.html">
   Galveston Island Damage Model: BRIDGES
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Damage_Transportation_Roadways/RoadwaysDamage_05_18_22.html">
   Galveston Island Damage Model: Roadways
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Social
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Galveston Island Population Dislocation Analysis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/npr99/IN-CORE_Galveston/kooshan_main?urlpath=lab/tree/jupyter_book/notebooks/03_Social_PopulationDislocationAnalysis/PopulationDisAnalysis_05_31_22.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/npr99/IN-CORE_Galveston/blob/kooshan_main/jupyter_book/notebooks/03_Social_PopulationDislocationAnalysis/PopulationDisAnalysis_05_31_22.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/npr99/IN-CORE_Galveston"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/npr99/IN-CORE_Galveston/issues/new?title=Issue%20on%20page%20%2Fnotebooks/03_Social_PopulationDislocationAnalysis/PopulationDisAnalysis_05_31_22.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notebooks/03_Social_PopulationDislocationAnalysis/PopulationDisAnalysis_05_31_22.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Galveston Island Population Dislocation Analysis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization">
     1) Initialization
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions-for-visualizing-the-population-data-results-as-tables">
     2-1) Functions for visualizing the population data results as tables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-an-alternative-plotting-function-to-plot-spatially">
     2-2) Setting up an alternative plotting function to plot spatially
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-the-hazard-data">
     3) Select the hazard data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-is-the-your-desired-hurricane-simulation">
       What is the your desired hurricane simulation?
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-community-description">
   1) Initial community description
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-built-environment">
     1a) Built Environment
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#buildings">
       Buildings
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-social-systems">
     1b) Social Systems
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-1b-interdependent-community-description">
     1a + 1b) Interdependent Community Description
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#set-up-and-run-housing-unit-allocation">
       Set Up and Run Housing Unit Allocation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#explore-results-from-housing-unit-allocation">
       Explore results from Housing Unit Allocation
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#validate-the-housing-unit-allocation-has-worked">
         Validate the Housing Unit Allocation has worked
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hazards-and-damages">
   2) Hazards and Damages
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-hazard-model-hurricane">
     2a) Hazard Model (Hurricane)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coupled-adcirc-swan">
       Coupled ADCIRC+SWAN
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#kriging-based-surrogate-model">
       Kriging-based surrogate model
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#building-damage">
       Building damage
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#building-fragility">
       2.1 Building Fragility
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       2.2 Building Damage
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functionality">
   3) Functionality
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-functionality-models">
     3a) Functionality Models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-functionality-of-physical-infrastructure">
     3b) Functionality of Physical Infrastructure
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-social-science-modules">
     3d) Social Science Modules
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-1-use-new-pyincore-data-utility-to-obtain-block-group-data-for-county">
       3d.1 Use new pyincore-data utility to obtain Block Group Data for County
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-2-population-dislocation">
       3d.2 Population Dislocation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-3-explore-population-dislocation-results">
       3.d.3 Explore Population Dislocation Results
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-4-explore-population-dislocation-and-building-damage-results">
       3.d.4 Explore Population Dislocation and Building Damage Results
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recovery">
   4) Recovery
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#household-level-housing-recovery-analysis">
     4.1 Household-Level Housing Recovery Analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-and-run-household-level-housing-sequential-recovery">
     4.2 Set Up and Run Household-level Housing Sequential Recovery
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#population-dislocation-results-error">
     Population Dislocation results error
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-sufficient-quality-solutions-found">
     6 a) Sufficient Quality Solutions Found?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-policy-lever-and-decision-combinations">
     8b) Policy Lever and Decision Combinations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   POST PROCESSING
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-functionality-of-physical-infrastructure">
     Postprocessing: Functionality of Physical Infrastructure
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-social-science-modules">
     Postprocessing: Social Science Modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-recovery">
     Postprocessing: Recovery
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     6a) Sufficient Quality Solutions Found?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Galveston Island Population Dislocation Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Galveston Island Population Dislocation Analysis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization">
     1) Initialization
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions-for-visualizing-the-population-data-results-as-tables">
     2-1) Functions for visualizing the population data results as tables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-an-alternative-plotting-function-to-plot-spatially">
     2-2) Setting up an alternative plotting function to plot spatially
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-the-hazard-data">
     3) Select the hazard data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-is-the-your-desired-hurricane-simulation">
       What is the your desired hurricane simulation?
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-community-description">
   1) Initial community description
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-built-environment">
     1a) Built Environment
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#buildings">
       Buildings
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-social-systems">
     1b) Social Systems
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-1b-interdependent-community-description">
     1a + 1b) Interdependent Community Description
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#set-up-and-run-housing-unit-allocation">
       Set Up and Run Housing Unit Allocation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#explore-results-from-housing-unit-allocation">
       Explore results from Housing Unit Allocation
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#validate-the-housing-unit-allocation-has-worked">
         Validate the Housing Unit Allocation has worked
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hazards-and-damages">
   2) Hazards and Damages
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-hazard-model-hurricane">
     2a) Hazard Model (Hurricane)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coupled-adcirc-swan">
       Coupled ADCIRC+SWAN
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#kriging-based-surrogate-model">
       Kriging-based surrogate model
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#building-damage">
       Building damage
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#building-fragility">
       2.1 Building Fragility
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       2.2 Building Damage
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functionality">
   3) Functionality
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-functionality-models">
     3a) Functionality Models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-functionality-of-physical-infrastructure">
     3b) Functionality of Physical Infrastructure
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-social-science-modules">
     3d) Social Science Modules
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-1-use-new-pyincore-data-utility-to-obtain-block-group-data-for-county">
       3d.1 Use new pyincore-data utility to obtain Block Group Data for County
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-2-population-dislocation">
       3d.2 Population Dislocation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-3-explore-population-dislocation-results">
       3.d.3 Explore Population Dislocation Results
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-4-explore-population-dislocation-and-building-damage-results">
       3.d.4 Explore Population Dislocation and Building Damage Results
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recovery">
   4) Recovery
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#household-level-housing-recovery-analysis">
     4.1 Household-Level Housing Recovery Analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-and-run-household-level-housing-sequential-recovery">
     4.2 Set Up and Run Household-level Housing Sequential Recovery
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#population-dislocation-results-error">
     Population Dislocation results error
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-sufficient-quality-solutions-found">
     6 a) Sufficient Quality Solutions Found?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-policy-lever-and-decision-combinations">
     8b) Policy Lever and Decision Combinations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   POST PROCESSING
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-functionality-of-physical-infrastructure">
     Postprocessing: Functionality of Physical Infrastructure
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-social-science-modules">
     Postprocessing: Social Science Modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-recovery">
     Postprocessing: Recovery
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     6a) Sufficient Quality Solutions Found?
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p>![IN-CORE_resilience-logo.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATQAAADACAYAAACK9Z8kAAAAAXNSR0IArs4c6QAAActpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgSW1hZ2VSZWFkeTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KKS7NPQAAEoZJREFUeAHtnVusFdUZx9c+HKsR5WLiLVABaVohyqUPikkVqNT2QQ+oD8ZoBVK1MRWRlzYCCSERTe2DoDWm1sixlTaaqIA+VKEV9AE0TQU0YpoKaDX1FhErttZz9nR96+y92ezrzOy1ZtbM/FZCmD0ze11+3zr//X1r1lqjFAkCEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAELBEoW8iALCEAggwTKR/cGaugzazXvGzs3dT1JvQLWaJIRBApEoF6Mgi/3qWDoSK31wb9frh3LQXB0r1LDx64fd9Hih2/M+U/qepJ6BSzyJCsIZJ5A+b+HAvXVOyow/9417akJVOW8r41E0Hy1DPWCgEMC5SM7g0B7TMHRfUr9710jXlURc1is86wRNOeIKQAC6RAIhj4LJNQz4eBXWrQkLEwo9EunxUr5IGj9aTWeciGQFwISJo4IlhYtPX4lwvX1X8/OS/My1Q7G0DJlLiqbNgHxvMqfv2TCxap4JTHgnna7w5SPhxaGEvdAIEUC8jQxEAH78nUl/+N5pWiMEEXjoYWAxC3FIWDCx8PPavF6WYknhvcV3vZ4aOFZcScEnBCohZCHnzMe2NCeaU7KIdNkCPBQIBnOlOIRgWoYWdYiRgjpkWEsVAVBswCRLPwnICJW/vhxFehwcuj1Of5XmBrGIoCgxcLGl7JAABHLgpXs1hFBs8uT3FImIIP65Q8exBNL2Q5pFY+gpUWecq0RMAP7n25VImQM6lvDmsmMELRMmo1KCwFZE1n+ZBMD+xG7Q2nMpR2/UTpxkl7HdE7He5ou6qVdSj3ZdDrpE8xDS5o45fVEwHhjH//eeGOyI0Uh06ixqjR6pml6SR+rk2fUMPSNuaR2LAc+7FF2XIUcf0DQHAMmezsEzNjY+3ersg4tcz3ZtSJW9UJVFSkRsVL/OP5mO3Qp4HSAw6X0CZiwUo+NlfV0i7wkE9LpsK4knpUWMCNY/eNU3+iZ/D32aGQA9giQr7shMPzp1pGnlbL8KKup6m2deokqnXiO/jepcCFg0qZD0JImTnkdCQx/9LugrEPLrI2PiVgZj0t7XeJxER52NLOziwiaM7RkHIVA1oRMnhSWxPMaLQKmjxnbimJuZ/ciaM7QknEYAjJGNiwemeehZVXAxPsq2pPDMHb05R4EzRdLFKwesixp+J2feytkEj6Wxl9pwkcELDudE0HLjq1yUVOZRyZCVtZzybxK8rTxtAEdRn5v5H9CSK/ME7YyCFpYUtzXM4Ghf96ln1z+2pt5ZGYgX7yw8VcQRvZsXT8yQND8sEOua2HGyQ781IsnlzURO/0G5n3lsNd5IWhmFrjeq4rUO4E++UM9abIXdvUmvJRw8vQf63+IWO89zO8cvOj48gs+tP9HfpPKSO36p/3Ji/BJJsYOv31LquFlnw4nS1rERp024EU/z0gXynQ12W0j0+bzr/LGK9NCNvz3a1OpnJmNf9bPjEc2Mjcs/R0gUgFR0EIRtIIa3kWzxSv7+rXzUvHKjvfGlunmyT9S0QggaEWzuIP2VsfKEvfKKlMt+iasrIwb4o05MG+mskTQMmUu/yorE2TlpSOJrr0UITvrNjXq7NsqS44e9g8MNUqFAIKWCvZ8FDr8rweMmCXVGjM+Jt6YTIA1E19XJ1U05WSEAIKWEUP5VM1aiKln/CeRqkI26owb9dPKG5MokjIySgBBy6jh0qq2CTHf/KEKzB7yjmtRCS37v7kaIXOMOi/ZI2h5sWQC7TDzBbWYOd8Cu2mMLIHGUUQuCPTlohU0wjkB2a/MTH4ePuK0LJnR33/BbiVeGXuMOUWdy8wRtFya1W6jht6+JRjWazFdJtmuR1Y59E99uOTL0i2X7SVvNwQQNDdcc5GrDP6LmDnd6keHl6Mm3atOmPFKiX3HctFtUm0EY2ip4ve3cCNmjgf/ZXZ/nxYzPDJ/+0HWaoaHljWLJVBf52ImXtm3n1D933mS8DIBexapCC88NHlDjoyfkEYIlD/ZlNqOrrKV05BDz0y8slFTH+alInR2JwT8EDS2Oz7OuLKz63EnEvpQXcbkZFqGeGUTV+nlSsv0nDLWXCZk0sIV44WgFY66hw2uTph1IWbyBFO8Mt4M7qHhc1YlxtByZtA4zXEpZrKI3DzBHD2TTRbjGIfvRCKAhxYJV/5urj4AsO6ZVaZjjKy/zB83WuQnAQTNT7skUquqmNlelymLyeUpJiFmImakkDoCCFodjCIdOhOzMZeqfi1mLFsqUm/yp62Moflji0RrIi8wse2ZyTrME6Y/zxrMRC1JYfUEELR6GgU5NsuZDj9rtbWyfEnWYVrNlMwgEJEAghYRWNZvl10zbK/NHHXubyrzy7JOh/pnnQBjaFm3YIT6W3//KU8yI9Dn1iQIIGhJUPagDLOkSb/MxFrSYtY//XmeZFoDSkY2CBBy2qCYgTzMK+Zsbc6ImGXA4sWsIoJWALvLQwBrTzQRswL0mOw2EUHLru1C1VzeZm7tIQBiFoo5N6VHgDG09Ng7L9n2uJlMzWD2v3OzUUAPBPDQeoDn+1fNewAsjZuZqRnmvZi+t5r6FZkAgpZT68ueasHnL1lpXd8EvY8ZYmaFJZm4JUDI6ZZvKrnXNmq0ULp5rZx50a+FzMgCAo4J4KE5BpxG9rJO00Yyr5ZjOZMNlOSREAEELSHQSRVT/uBBO4vOK080k6o35UDABgEEzQZFj/IoW1p0LqsA2ALII8NSlVAEELRQmIp1E9MzimXvPLUWQcuTNS20xbxmzryZyUJmZAGBhAkgaAkD97o4PW4mb2ciQSCrBJi2kVXLOah3HrfOfu3tN4PPjn7eltasc6ep8aeMZWPKtoSydcELQTv44XvB4PanIpGbfOZEtXTBNS074sbtTwWHPnzPWn6S0Yv7dgc7Xn8ldJ5rr1/esm6hM0j4RnndXN/YubHrXOWz9+BbqpOARGnWfTetUrOnTg9dJ+lHm3dtUzvfeFXtOfCmOvTR+2r28oHuRV7xrUCEbd4FF6m551+orrr48tBlVjNfs2mDs5dDjxs9Rkn95s+YE6leVZtU6+j6fx/6vBeCJuKz9o8PROItna9deuzPT6so4iP5SKfplCS/qHXslJ9P18xbmvRbzZX6VeRq3bd5Y7Bh66Cav/KGyN/t9oXNu7d1u8VcFyFb8dt1aspP5oW6v9VNew7s1yK4X63fMqjGXfvdYPnAYnXHwiWhvbdE+oYW3iWXXa2WDywJJfR57rOtbCjnGEOrkBGv4pldLzj7lW1nAB/OyzrNqFM0Dn9xJJh35/XBikfWGU8orXaINy5CFlb8wtRT+oII1OzbB5SErGG+k9Q9g/rHWrxOaXdSZWapHAStzlpbdm+v+1SMQ3mqGSfUFI8oqhdsm6j8US9d/wvb2dbyk5BVPE/fRE0qKO1G1Gqmqh0gaDUUSv/Kb1fiedSdyvehfqrZp7cEippkbEY8hTST1MGlmFXbJt7aVetu9bJfyI9Kofpr1Sgd/kfQ6uBI5xVRK0oyDwJOmhxpoFnYyBhl2imRMatKI8VTk7E135L018Ht6dvCJy4IWoM1ihJ2mgcBZ9/W0PpwH9MWfQkBkw53N2x9LBychO+SJ7qkYwQQtGMszJEMLhfBje+bsDLygwABJE8UxTNIMz32l+S9Emmzjw+NZHoK6RgBBO0Yi9pR2h5IrSKODox3FnPDxqjz+1w0QaZXpJHSKrdTWyUcJh0jgKAdY1E7knlVeU5xHgT4xCPpcLPadsK7Kgl///diYq1veOSXWEKrKWdOjDxgbqMtpRPPUaUxl9rIqikP452dNhC7XXHEZPIZE5Ss7Iia4nynVRkyy15WHTQmF5OBG8vo9LnV5PA4fDuVEfVaXFtJOTue+0fU4qzfj6C1QSpLaNJKedu/f7Ge3R5nWcyOezZZMYGsAmm5bEjPvLdSQMxMdPuaf1hSrlNcW8VEYP1rhJxtkKYx8NymKpz2hEDa3pMnGLyuBoLWxjwSdvo4Q7xNdTkNAQhoAghah26Al9YBDpcg4CEBBK2DUdIcR+tQLS5BAAJtCCBobcDIaZnjQ9jZARCXIOAZAQSti0HyPietS/O5DIFMEUDQupgr76sGujSfyxDIFAEErYu5fF3D16XaXIZAIQkwsTaE2WUHjkl6tjsJAnknYLZliji5d811y2JNnHbBEkELQVXCziULrg5xp51bZCdSV3uOyTKg9Tevbp6hbqfq5AKBVAkgaCHwS9iZ5BQO2dGCWekhDMMtEGggwBhaA5B2H9mmpR0ZzkPAHwIImj+2oCYQgECPBBA0DVC2TCFBAALZJ4CgaRvKi1tJEIBA9gkgaNqGiy7+QfYtSQsgAAHFU07dCWRn2lm3Xxn4uGc8fTTHBCLO92pFQoZLDqn0d4ptVbc0zuGhVagv/n5y88zSMDRl5pPArHOn57NhMVuFh1YBJ2HnikfWxcTI1yCQDoGFcxaozeoha4XLew7mnn9hpPzkO2sjfcPdzQhahS1hp7tORs5uCEi4uXTBNVZXfYiYRX3/gy9iJpQRtLq+JmHnngPpe2lLFlyjWr0RqK6qsQ/lhSGzLb18JHYl+GLPBMSOz6x6SM1+lJCzHiaCVkfDl7Azrdfn1aHg0GMC4pkZMZs63ap35nGTQ1eNhwJ1qEzYqRdvkyDgIwHx2jfe8Ut16NGdpdmIWUsTIWgNWHja2QCEj94QkJ1SbI+ZedM4SxVB0BpAJrlNUEPRfIRARwKD25/ueJ2LvMauqQ+MP2VsadEcVg40geGEdQLicUVJso2V7JUX5TtFuxcPrYXFZW4PCQKNBOTJos0UZw0xL+3pbAEErQWfRQhaCyqciupRdSMWp5/J8jxerdieLNM2WrAxYeddtwabd29rcbXYp+J4KTvfeFWt2bQhcqgkT/Xmz5jT89QECdVe3Le7qfz5K29I1Zhx+5lLL022fp935/VNrMKA2nHPpp5tFaacTvcgaG3omCUlCFoTnTheimwnnuaW4uLV2BCvOGLeBLDhRJx+Ju+4OPzFkUAEsSG7nj/KzsxZ3p2ZkLNNF4gTDrTJitOWCbhaRdGtmjOnnNftlsjXpZ9FFUrzjgstaqRmAghaMxNzhqedrcFMPnNi6wsJno3jJdqongshHeln0R9Crf3D/TaalLs8ELQOJuVpZzMcWU0R1aNozqW3Mwsvii4AvZU4sk27jfG8VvWI088kLGw1Ltgq/yKdQ9A6WJuwszWctLmIsCT9HojFl7nbL++qiy+P9SPh6t2tra2ejbMIWgc7EXa2huPyj7t1ic1nZU1jUklC3Khb6kStW5wfiUH9RFIeDkQtK8/3I2hdrBsnHOiSZeYvi4d0x8IlqbZD6rDmumXO6yDh9cbl7sUz7o/E+i2DzhlkqQAErYu14vxydskyF5fX37y6tMRhGBYGknhN9920Ksytse4Rz+zFux9XSexsETeMJuw83rQI2vE8mj4RdjYhqZ0YXHFvSUK/pMezahXQBysWLS29tmGr1Q0xxSsT72/P/c8muk1PnLePycOBZ3a9QNhZ6RReTKyVqQBRwwf5jp6ZXN+3a8fivkfZF33tc8tr3211sHxgsYo6B6lbnq3KyeK56nY2shxHVlbsPfiWknlSNlLY6RlVD+rgh+8Fm3dtU1te2a53Ht4fqR5S1qwp05QMMcgg/don/hapCVH7r2Te2EdkbefYk0+NVG6nm11MM+lUXmN7Ot3r6pr1mcauKkq+EIhDoNvUBvlhZIfgOGT5DgQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIBAYgT+D6+SMn0jjUoTAAAAAElFTkSuQmCC)</p>
<section class="tex2jax_ignore mathjax_ignore" id="galveston-island-population-dislocation-analysis">
<h1>Galveston Island Population Dislocation Analysis<a class="headerlink" href="#galveston-island-population-dislocation-analysis" title="Permalink to this headline">#</a></h1>
<p><strong>Jupyter Notebook Created by</strong>:</p>
<ul class="simple">
<li><p>Mehrzad Rahimi, Postdoctoral fellow at Rice University (<a class="reference external" href="mailto:mr77&#37;&#52;&#48;rice&#46;edu">mr77<span>&#64;</span>rice<span>&#46;</span>edu</a>)</p></li>
<li><p>Nathanael Rosenheim, Research Associate Professor at Texas A&amp;M University (<a class="reference external" href="mailto:nrosenheim&#37;&#52;&#48;arch&#46;tamu&#46;edu">nrosenheim<span>&#64;</span>arch<span>&#46;</span>tamu<span>&#46;</span>edu</a>)</p></li>
<li><p>Jamie E. Padgett, Professor at Rice University (<a class="reference external" href="mailto:jamie&#46;padgett&#37;&#52;&#48;rice&#46;edu">jamie<span>&#46;</span>padgett<span>&#64;</span>rice<span>&#46;</span>edu</a>)</p></li>
</ul>
<section id="initialization">
<h2>1) Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span> 
<span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">ctx</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">pyincore</span> <span class="kn">import</span> <span class="n">IncoreClient</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataService</span><span class="p">,</span> <span class="n">HazardService</span><span class="p">,</span> <span class="n">FragilityService</span><span class="p">,</span> <span class="n">MappingSet</span><span class="p">,</span> <span class="n">FragilityCurveSet</span>
<span class="kn">from</span> <span class="nn">pyincore_viz.geoutil</span> <span class="kn">import</span> <span class="n">GeoUtil</span> <span class="k">as</span> <span class="n">geoviz</span>
<span class="kn">from</span> <span class="nn">pyincore_viz.plotutil</span> <span class="kn">import</span> <span class="n">PlotUtil</span> <span class="k">as</span> <span class="n">plotviz</span>

<span class="c1"># importing pyIncone analyses:</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.buildingdamage</span> <span class="kn">import</span> <span class="n">BuildingDamage</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.bridgedamage</span> <span class="kn">import</span> <span class="n">BridgeDamage</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.roaddamage</span> <span class="kn">import</span> <span class="n">RoadDamage</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.epfdamage</span> <span class="kn">import</span> <span class="n">EpfDamage</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.buildingfunctionality</span> <span class="kn">import</span> <span class="n">BuildingFunctionality</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.housingunitallocation</span> <span class="kn">import</span> <span class="n">HousingUnitAllocation</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.populationdislocation</span> <span class="kn">import</span> <span class="n">PopulationDislocation</span><span class="p">,</span> <span class="n">PopulationDislocationUtil</span>
<span class="kn">from</span> <span class="nn">pyincore.analyses.housingrecoverysequential</span> <span class="kn">import</span> <span class="n">HousingRecoverySequential</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check package versions - good practice for replication</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Python Version &quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pandas version: &quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;numpy version: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python Version  3.9.15 | packaged by conda-forge | (main, Nov 22 2022, 08:41:22) [MSC v.1929 64 bit (AMD64)]
pandas version:  1.5.2
numpy version:  1.24.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check working directory - good practice for relative path access</span>
<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;C:\\Users\\Kooshan\\Box\\Rice\\Software_Projects\\Pycharm\\IN-CORE_Galveston\\jupyter_book\\notebooks\\03_Social_PopulationDislocationAnalysis&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">IncoreClient</span><span class="p">()</span>
<span class="c1"># IN-CORE caches files on the local machine, it might be necessary to clear the memory</span>
<span class="c1">#client.clear_cache() </span>
<span class="n">data_service</span> <span class="o">=</span> <span class="n">DataService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="c1"># create data_service object for loading files</span>
<span class="n">hazard_service</span> <span class="o">=</span> <span class="n">HazardService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="n">fragility_service</span> <span class="o">=</span> <span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StdinNotImplementedError</span><span class="g g-Whitespace">                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">client</span> <span class="o">=</span> <span class="n">IncoreClient</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># IN-CORE caches files on the local machine, it might be necessary to clear the memory</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1">#client.clear_cache() </span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">data_service</span> <span class="o">=</span> <span class="n">DataService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="c1"># create data_service object for loading files</span>

<span class="nn">File ~\anaconda3\envs\IN-CORE_Galveston\lib\site-packages\pyincore\client.py:228,</span> in <span class="ni">IncoreClient.__init__</span><span class="nt">(self, service_url, token_file_name)</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connection successful to IN-CORE services.&quot;</span><span class="p">,</span> <span class="s2">&quot;pyIncore version detected:&quot;</span><span class="p">,</span> <span class="n">pyglobals</span><span class="o">.</span><span class="n">PACKAGE_VERSION</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">228</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connection successful to IN-CORE services.&quot;</span><span class="p">,</span> <span class="s2">&quot;pyIncore version detected:&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>               <span class="n">pyglobals</span><span class="o">.</span><span class="n">PACKAGE_VERSION</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\IN-CORE_Galveston\lib\site-packages\pyincore\client.py:235,</span> in <span class="ni">IncoreClient.login</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span> <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pyglobals</span><span class="o">.</span><span class="n">MAX_LOGIN_ATTEMPTS</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">235</span>         <span class="n">username</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter username: &quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span>         <span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s2">&quot;Enter password: &quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">237</span>     <span class="k">except</span> <span class="ne">EOFError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">File ~\anaconda3\envs\IN-CORE_Galveston\lib\site-packages\ipykernel\kernelbase.py:1186,</span> in <span class="ni">Kernel.raw_input</span><span class="nt">(self, prompt)</span>
<span class="g g-Whitespace">   </span><span class="mi">1184</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allow_stdin</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1185</span>     <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;raw_input was called, but this frontend does not support input requests.&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1186</span>     <span class="k">raise</span> <span class="n">StdinNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1187</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_request</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1188</span>     <span class="nb">str</span><span class="p">(</span><span class="n">prompt</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1189</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_parent_ident</span><span class="p">[</span><span class="s2">&quot;shell&quot;</span><span class="p">],</span>
<span class="g g-Whitespace">   </span><span class="mi">1190</span>     <span class="bp">self</span><span class="o">.</span><span class="n">get_parent</span><span class="p">(</span><span class="s2">&quot;shell&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1191</span>     <span class="n">password</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1192</span> <span class="p">)</span>

<span class="ne">StdinNotImplementedError</span>: raw_input was called, but this frontend does not support input requests.
</pre></div>
</div>
</div>
</div>
</section>
<section id="functions-for-visualizing-the-population-data-results-as-tables">
<h2>2-1) Functions for visualizing the population data results as tables<a class="headerlink" href="#functions-for-visualizing-the-population-data-results-as-tables" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Functions for visualizing the population data results as tables</span>
<span class="kn">from</span> <span class="nn">pyincore_viz.analysis.popresultstable</span> <span class="kn">import</span> <span class="n">PopResultsTable</span> <span class="k">as</span> <span class="n">poptable</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="setting-up-an-alternative-plotting-function-to-plot-spatially">
<h2>2-2) Setting up an alternative plotting function to plot spatially<a class="headerlink" href="#setting-up-an-alternative-plotting-function-to-plot-spatially" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="k">def</span> <span class="nf">plot_gdf_map</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">basemap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">OpenStreetMap</span><span class="o">.</span><span class="n">Mapnik</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Taken from pyincore-viz. </span>
<span class="sd">    Not using the pyincore-viz version b/c it&#39;s limited on plotting options</span>
<span class="sd">        - Added **kwargs for more control over the geopandas plotting function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># adding a colorbar to side</span>
        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
                      <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
                      <span class="n">categorical</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> 
                      <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                      <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
                      <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
                      <span class="n">categorical</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> 
                      <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        
    <span class="k">if</span> <span class="n">basemap</span><span class="p">:</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-the-hazard-data">
<h2>3) Select the hazard data<a class="headerlink" href="#select-the-hazard-data" title="Permalink to this headline">#</a></h2>
<section id="what-is-the-your-desired-hurricane-simulation">
<h3>What is the your desired hurricane simulation?<a class="headerlink" href="#what-is-the-your-desired-hurricane-simulation" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hazard_type</span> <span class="o">=</span> <span class="s2">&quot;hurricane&quot;</span>
<span class="n">hur_no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;The No. of your desired hurricane simulation: &#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The No. of your desired hurricane simulation: 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hazard_id_dict</span>      <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;5fa5a228b6429615aeea4410&quot;</span><span class="p">,</span> 
                       <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;5fa5a83c7e5cdf51ebf1adae&quot;</span><span class="p">,</span>
                       <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;5fa5a9497e5cdf51ebf1add2&quot;</span><span class="p">,</span>
                       <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;5fa5aa19b6429615aeea4476&quot;</span><span class="p">,}</span>

<span class="n">wave_height_id_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;5fa5a1efea0fb7498ec00fb4&quot;</span><span class="p">,</span> 
                       <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;5fa5a805ea0fb7498ec00fec&quot;</span><span class="p">,</span>
                       <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;5fa5a91793e8142dedeca468&quot;</span><span class="p">,</span>
                       <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;5fa5a9f263e5b32b503655a3&quot;</span><span class="p">,}</span>

<span class="n">surge_level_id</span>      <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;5fa5a1f893e8142dedeca251&quot;</span><span class="p">,</span> 
                       <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;5fa5a80c63e5b32b50365557&quot;</span><span class="p">,</span>
                       <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;5fa5a91d93e8142dedeca498&quot;</span><span class="p">,</span>
                       <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;5fa5a9f893e8142dedeca4c8&quot;</span><span class="p">,}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hazard_id</span> <span class="o">=</span> <span class="n">hazard_id_dict</span><span class="p">[</span><span class="n">hur_no</span><span class="p">]</span>
<span class="n">wave_height_id</span> <span class="o">=</span> <span class="n">wave_height_id_dict</span><span class="p">[</span><span class="n">hur_no</span><span class="p">]</span>
<span class="n">surge_level_id</span> <span class="o">=</span> <span class="n">surge_level_id</span><span class="p">[</span><span class="n">hur_no</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="initial-community-description">
<h1>1) Initial community description<a class="headerlink" href="#initial-community-description" title="Permalink to this headline">#</a></h1>
<p><img alt="initialcommunitydescription.png" src="notebooks/03_Social_PopulationDislocationAnalysis/attachment:initialcommunitydescription.png" /></p>
<p>Step 1 in IN-CORE is to establish initial community description at time 0 and with policy levers and decision combinations (PD) set to K (baseline case). The community description includes three parts including <strong>1a) Built Environment</strong>, <strong>1b) Social Systems</strong>, and <strong>1c) Economic Systems</strong>.</p>
<section id="a-built-environment">
<h2>1a) Built Environment<a class="headerlink" href="#a-built-environment" title="Permalink to this headline">#</a></h2>
<p>The Galveston testbed consists of five infrastructure systems as buildings, transportation network, electric power transmission and distribution network, water/wastewater network, and critical facilities. Each infrastructure system may be composed of different infrastructure components. For example, the transportation network consists of bridges and roadways. The infrastructure systems and components are shown below along with their IN-CORE GUID.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>No.</p></th>
<th class="head"><p>Infrastructure System</p></th>
<th class="head"><p>Infrastructure Component</p></th>
<th class="head"><p>GUID</p></th>
<th class="head"><p>More details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Buildings</p></td>
<td><p>-</p></td>
<td><p>60354b6c123b4036e6837ef7</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Transportation network</p></td>
<td><p>Bridges</p></td>
<td><p>60620320be94522d1cb9f7f0</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>Transportation network</p></td>
<td><p>Roadways</p></td>
<td><p>5f15d04f33b2700c11fc9c4e</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Electric power network</p></td>
<td><p>Connectivity</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>Electric power network</p></td>
<td><p>Poles and Towers</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Electric power network</p></td>
<td><p>Substation</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>Electric power network</p></td>
<td><p>Transmission</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Electric power network</p></td>
<td><p>Underground</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Water/wastewater network</p></td>
<td><p>Water mains</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Water/wastewater network</p></td>
<td><p>Water plants</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>Water/wastewater network</p></td>
<td><p>Wastewater mains</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Critical facilities</p></td>
<td><p>Hospitals</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>Critical facilities</p></td>
<td><p>Urgent care</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Critical facilities</p></td>
<td><p>Emergency medical facilities</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>Critical facilities</p></td>
<td><p>Fire stations</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Fiber Optic Network</p></td>
<td><p>-</p></td>
<td><p>Outside of IN-CORE</p></td>
<td><p>Ref.</p></td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: The built environment in the Galveston testbed are in the Galveston Island. However, as the goal is to capture flow of people during recovery stages, buildings and transportation networks in the Galveston mainland are considered as well.</p>
<section id="buildings">
<h3>Buildings<a class="headerlink" href="#buildings" title="Permalink to this headline">#</a></h3>
<p>The building inventory for Galveston consists of 18,962 individual residential households. This inventory is also mappable to housing unit info of 32,501 individual households explained later in this notebook. It should be noted that the reason that the building and household data are different in terms of numbers is that each individual building can be composed of a few households. The building inventory consists of three major parameters that are used to estimate the fragility of buildings explained shortly later in this notebook. The three parameters are:</p>
<p>a) Elevation of the lowest horizontal structural member</p>
<p>b) Age group of the building (1, 2, 3, and 4 representing age group pre-1974, 19741987, 19871995, and 1995 2008, respectively)</p>
<p>c) Elevation of the building with respect to the ground</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_dataset_id</span> <span class="o">=</span> <span class="s2">&quot;60354b6c123b4036e6837ef7&quot;</span>               <span class="c1"># defining building dataset (GIS point layer)       </span>
<span class="n">bldg_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">bldg_dataset_id</span><span class="p">,</span> <span class="n">data_service</span><span class="p">)</span>
<span class="n">geoviz</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">bldg_dataset</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;age_group&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Galveston testbed building inventory as a function of age group&#39;</span><span class="p">)</span>

<span class="n">bldg_df</span> <span class="o">=</span> <span class="n">bldg_dataset</span><span class="o">.</span><span class="n">get_dataframe_from_shapefile</span><span class="p">()</span>
<span class="c1">#bldg_df.set_index(&#39;guid&#39;, inplace=True)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of buildings: </span><span class="si">{}</span><span class="s1">&#39;</span> <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bldg_df</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset already exists locally. Reading from local cached zip.
Unzipped folder found in the local cache. Reading from it...
Galveston testbed building inventory as a function of age group
Number of buildings: 18962
</pre></div>
</div>
<img alt="../../_images/PopulationDisAnalysis_05_31_22_21_1.png" src="../../_images/PopulationDisAnalysis_05_31_22_21_1.png" />
</div>
</div>
</section>
</section>
<section id="b-social-systems">
<h2>1b) Social Systems<a class="headerlink" href="#b-social-systems" title="Permalink to this headline">#</a></h2>
<p>The Galveston Island has a permanent resident population of approximately 53,695 people (US Census, 2020). In 2010, the total population living on Galveston Island was 48,726. This section performs a housing unit allocation. The housing unit inventory includes characteristics for individual households and housing units that can be linked to residential buildings. For more information see Rosenheim et al. (2019).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Housing Unit inventory</span>
<span class="n">housing_unit_inv_id</span> <span class="o">=</span> <span class="s2">&quot;61d783eb3ed7dd5c873b42d2&quot;</span>
<span class="c1"># load housing unit inventory as pandas dataframe</span>
<span class="n">housing_unit_inv</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">housing_unit_inv_id</span><span class="p">,</span> <span class="n">data_service</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">housing_unit_inv</span><span class="o">.</span><span class="n">get_file_path</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The IN-CORE Dataservice has saved the Housing Unit Inventory on your local machine: &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset already exists locally. Reading from local cached zip.
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">BadZipFile</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">Input In [11],</span> in <span class="ni">&lt;cell line: 4&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">housing_unit_inv_id</span> <span class="o">=</span> <span class="s2">&quot;61d783eb3ed7dd5c873b42d2&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># load housing unit inventory as pandas dataframe</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">housing_unit_inv</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">housing_unit_inv_id</span><span class="p">,</span> <span class="n">data_service</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">housing_unit_inv</span><span class="o">.</span><span class="n">get_file_path</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The IN-CORE Dataservice has saved the Housing Unit Inventory on your local machine: &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/pyincoreEnv/lib/python3.9/site-packages/pyincore/dataset.py:59,</span> in <span class="ni">Dataset.from_data_service</span><span class="nt">(cls, id, data_service)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">data_service</span><span class="o">.</span><span class="n">get_dataset_metadata</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">59</span> <span class="n">instance</span><span class="o">.</span><span class="n">cache_files</span><span class="p">(</span><span class="n">data_service</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="k">return</span> <span class="n">instance</span>

<span class="nn">File ~/opt/anaconda3/envs/pyincoreEnv/lib/python3.9/site-packages/pyincore/dataset.py:178,</span> in <span class="ni">Dataset.cache_files</span><span class="nt">(self, data_service)</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>     <span class="k">return</span>
<span class="ne">--&gt; </span><span class="mi">178</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_file_path</span> <span class="o">=</span> <span class="n">data_service</span><span class="o">.</span><span class="n">get_dataset_blob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_file_path</span>

<span class="nn">File ~/opt/anaconda3/envs/pyincoreEnv/lib/python3.9/site-packages/pyincore/dataservice.py:115,</span> in <span class="ni">DataService.get_dataset_blob</span><span class="nt">(self, dataset_id, join)</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">local_filename</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>         <span class="n">local_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_dataset_blob</span><span class="p">(</span><span class="n">cache_data_dir</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">115</span> <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unzip_dataset</span><span class="p">(</span><span class="n">local_filename</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span> <span class="k">if</span> <span class="n">folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>     <span class="k">return</span> <span class="n">folder</span>

<span class="nn">File ~/opt/anaconda3/envs/pyincoreEnv/lib/python3.9/site-packages/pyincore/dataservice.py:379,</span> in <span class="ni">DataService.unzip_dataset</span><span class="nt">(self, local_filename)</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>     <span class="k">return</span> <span class="n">foldername</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span> <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">foldername</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">379</span> <span class="n">zip_ref</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">foldername</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File ~/opt/anaconda3/envs/pyincoreEnv/lib/python3.9/zipfile.py:1266,</span> in <span class="ni">ZipFile.__init__</span><span class="nt">(self, file, mode, compression, allowZip64, compresslevel, strict_timestamps)</span>
<span class="g g-Whitespace">   </span><span class="mi">1264</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1265</span>     <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1266</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_RealGetContents</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1267</span>     <span class="k">elif</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1268</span>         <span class="c1"># set the modified flag so central directory gets written</span>
<span class="g g-Whitespace">   </span><span class="mi">1269</span>         <span class="c1"># even if no files are added to the archive</span>
<span class="g g-Whitespace">   </span><span class="mi">1270</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_didModify</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/opt/anaconda3/envs/pyincoreEnv/lib/python3.9/zipfile.py:1333,</span> in <span class="ni">ZipFile._RealGetContents</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1331</span>     <span class="k">raise</span> <span class="n">BadZipFile</span><span class="p">(</span><span class="s2">&quot;File is not a zip file&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1332</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">endrec</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1333</span>     <span class="k">raise</span> <span class="n">BadZipFile</span><span class="p">(</span><span class="s2">&quot;File is not a zip file&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1334</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1335</span>     <span class="nb">print</span><span class="p">(</span><span class="n">endrec</span><span class="p">)</span>

<span class="ne">BadZipFile</span>: File is not a zip file
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing_unit_inv_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;infer&quot;</span><span class="p">)</span>
<span class="n">housing_unit_inv_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing_unit_inv_df</span><span class="p">[</span><span class="s1">&#39;huid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">housing_unit_inv_df</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Householder&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Race, Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston County TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s2">&quot;Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Tenure Status&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-1b-interdependent-community-description">
<h2>1a + 1b) Interdependent Community Description<a class="headerlink" href="#a-1b-interdependent-community-description" title="Permalink to this headline">#</a></h2>
<p>Explore building inventory and social systems. Specifically look at how the building inventory connects with the housing unit inventory using the housing unit allocation.
The housing unit allocation method will provide detail demographic characteristics for the community allocated to each structure.</p>
<p>To run the HUA Algorithm, three input datasets are required:</p>
<ol class="simple">
<li><p>Housing Unit Inventory - Based on 2010 US Census Block Level Data</p></li>
<li><p>Address Point Inventory - A list of all possible residential/business address points in a community. Address points are the link between buildings and housing units.</p></li>
<li><p>Building Inventory - A list of all buildings within a community.</p></li>
</ol>
<section id="set-up-and-run-housing-unit-allocation">
<h3>Set Up and Run Housing Unit Allocation<a class="headerlink" href="#set-up-and-run-housing-unit-allocation" title="Permalink to this headline">#</a></h3>
<p>The building and housing unit inventories have already by loaded. The address point inventory is needed to link the population with the structures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create housing allocation </span>
<span class="n">hua</span> <span class="o">=</span> <span class="n">HousingUnitAllocation</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">address_point_inv_id</span> <span class="o">=</span> <span class="s2">&quot;5fc6aadcc38a0722f563392e&quot;</span>

<span class="c1"># Load input dataset</span>
<span class="n">hua</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;housing_unit_inventory&quot;</span><span class="p">,</span> <span class="n">housing_unit_inv_id</span><span class="p">)</span>
<span class="n">hua</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;address_point_inventory&quot;</span><span class="p">,</span> <span class="n">address_point_inv_id</span><span class="p">)</span>
<span class="n">hua</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">bldg_dataset_id</span><span class="p">)</span>

<span class="c1"># Specify the result name</span>
<span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Galveston_HUA&quot;</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">1238</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Set analysis parameters</span>
<span class="n">hua</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">hua</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<span class="n">hua</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">,</span> <span class="n">iterations</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Housing unit allocation analysis</span>
<span class="n">hua</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="explore-results-from-housing-unit-allocation">
<h3>Explore results from Housing Unit Allocation<a class="headerlink" href="#explore-results-from-housing-unit-allocation" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve result dataset</span>
<span class="n">hua_result</span> <span class="o">=</span> <span class="n">hua</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>

<span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">hua_df</span> <span class="o">=</span> <span class="n">hua_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Display top 5 rows of output data</span>
<span class="n">hua_df</span><span class="p">[[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;numprec&#39;</span><span class="p">,</span><span class="s1">&#39;incomegroup&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hua_df</span><span class="p">[[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Limit HUA Results to only observations with GUID and HUID</span>
<span class="n">hua_df_buildings</span> <span class="o">=</span> <span class="n">hua_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">hua_df</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> 
            <span class="p">(</span><span class="n">hua_df</span><span class="p">[</span><span class="s1">&#39;huid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">hua_df_buildings</span><span class="p">[[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update HUA results with housing unit inventory linked to buildings</span>
<span class="n">hua_result</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">hua_df_buildings</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="n">result_name</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;buildings.csv&quot;</span><span class="p">,</span>
                                    <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;incore:housingUnitAllocation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">hua_df_buildings</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Householder&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Race, Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island, TX - Buildings in Inventory&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s2">&quot;Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Tenure Status&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">hua_df_buildings</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Median Household Income&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Race, Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island, TX - Buildings in Inventory&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s2">&quot;Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Tenure Status&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="validate-the-housing-unit-allocation-has-worked">
<h4>Validate the Housing Unit Allocation has worked<a class="headerlink" href="#validate-the-housing-unit-allocation-has-worked" title="Permalink to this headline">#</a></h4>
<p>Notice that the population count totals for the community should match (pretty closely) data collected for the 2010 Decennial Census.
This can be confirmed by going to <a class="reference external" href="http://data.census.gov">data.census.gov</a></p>
<p>Total Population by Race and Ethnicity:
<a class="reference external" href="https://data.census.gov/cedsci/table?q=DECENNIALPL2010.P5&amp;g=1600000US4828068,4837252&amp;tid=DECENNIALSF12010.P5">https://data.census.gov/cedsci/table?q=DECENNIALPL2010.P5&amp;g=1600000US4828068,4837252&amp;tid=DECENNIALSF12010.P5</a></p>
<p>Median Income by Race and Ethnicity:</p>
<ul class="simple">
<li><p>All Households: <a class="reference external" href="https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013">https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013</a></p></li>
<li><p>Black Households: <a class="reference external" href="https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013B">https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013B</a></p></li>
<li><p>White, not Hispanic Households: <a class="reference external" href="https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013H">https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013H</a></p></li>
<li><p>Hispanic Households: <a class="reference external" href="https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013I">https://data.census.gov/cedsci/table?g=1600000US4828068,4837252&amp;tid=ACSDT5Y2012.B19013I</a></p></li>
</ul>
<p>Differences in the housing unit allocation and the Census count may be due to differences between political boundaries and the building inventory. See Rosenheim et al 2019 for more details.</p>
<p>The housing unit allocation, plus the building results will become the input for the social science models such as the population dislocation model.</p>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hazards-and-damages">
<h1>2) Hazards and Damages<a class="headerlink" href="#hazards-and-damages" title="Permalink to this headline">#</a></h1>
<p><img alt="HazardsandDamages.png" src="notebooks/03_Social_PopulationDislocationAnalysis/attachment:HazardsandDamages.png" /></p>
<section id="a-hazard-model-hurricane">
<h2>2a) Hazard Model (Hurricane)<a class="headerlink" href="#a-hazard-model-hurricane" title="Permalink to this headline">#</a></h2>
<p>There are currently five hurricane hazard data for Galveston testbed. Four of them were created using the dynamically coupled versions of the Advanced Circulation (ADCIRC) and Simulating Waves Nearshore (SWAN) models. One of them is a surrogate model developed using USACE datasets.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>No.</p></th>
<th class="head"><p>Simulation type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>GUID</p></th>
<th class="head"><p>More details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Coupled ADCIRC+SWAN</p></td>
<td><p>Hurricane Ike Hindcast</p></td>
<td><p><font color='red'>5fa5a228b6429615aeea4410 </font></p></td>
<td><p>Darestani et al. (2021)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Coupled ADCIRC+SWAN</p></td>
<td><p>2% AEP Hurricane Simulation</p></td>
<td><p><font color='red'>5fa5a83c7e5cdf51ebf1adae </font></p></td>
<td><p>Darestani et al. (2021)</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Coupled ADCIRC+SWAN</p></td>
<td><p>1% AEP Hurricane Simulation</p></td>
<td><p><font color='red'>5fa5a9497e5cdf51ebf1add2 </font></p></td>
<td><p>Darestani et al. (2021)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Coupled ADCIRC+SWAN</p></td>
<td><p>0.2% AEP Hurricane Simulation</p></td>
<td><p><font color='red'>5fa5aa19b6429615aeea4476 </font></p></td>
<td><p>Darestani et al. (2021)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Kriging-based surrogate model</p></td>
<td><p>Galveston Deterministic Hurricane - Kriging</p></td>
<td><p><font color='red'>5f15cd627db08c2ccc4e3bab </font></p></td>
<td><p>Fereshtehnejad et al. (2021)</p></td>
</tr>
</tbody>
</table>
<section id="coupled-adcirc-swan">
<h3>Coupled ADCIRC+SWAN<a class="headerlink" href="#coupled-adcirc-swan" title="Permalink to this headline">#</a></h3>
<p>Galveston Island was struck by Hurricane Ike in September, 2008, with maximum windspeeds of 49 m/s (95 kts) and storm surge elevations reaching at least +3.5 m (NAVD88) on Galveston Island. A full hindcast of Hurricane Ikes water levels, and wave conditions along with 2% (50-yr return period), 1% (100-yr return period), and 0.2% (500-yr return period) Annual Exceedance Probabilities (AEP) hurricane simulations were created using ADCIRC+SWAN models. These hurricane hazard events contain <strong>eight hazardDatasets</strong>, which is five more than the current pyincore hurricane schema. Please be sure to adjust your codes accordingly if you need to incorporate the five new intensity measures (IMs). The existing schema includes the peak significant wave height, peak surge level, and inundation duration. These new events include those as well as maximum inundation depth, peak wave period, wave direction, maximum current speed, and maximum wind speed.</p>
</section>
<section id="kriging-based-surrogate-model">
<h3>Kriging-based surrogate model<a class="headerlink" href="#kriging-based-surrogate-model" title="Permalink to this headline">#</a></h3>
<p><strong>Three hazardDatasets</strong> of kriging-based surrogate models are developed for peak significant wave height, peak surge level, and inundation duration. Training datasets for developing the Kriging surorgate models were collected through USACE. For the peak significant wave height, peak surge level, and inundation duration the training datasets included 61, 251, and 254 synthetic storms, respectively.</p>
</section>
<section id="building-damage">
<h3>Building damage<a class="headerlink" href="#building-damage" title="Permalink to this headline">#</a></h3>
</section>
<section id="building-fragility">
<h3>2.1 Building Fragility<a class="headerlink" href="#building-fragility" title="Permalink to this headline">#</a></h3>
<p>The fragility model used to estimate failure probability during storm surge events is extracted from:</p>
<blockquote>
<div><p>Tomiczek, T. Kennedy, A, and Rogers, S., 2013. Collapse limit state fragilities of wood-framed residences from storm surge and waves during Hurricane Ike. Journal of Waterway, Port, Coastal, and Ocean Engineering, 140(1), pp.43-55.</p>
</div></blockquote>
<p>This empirical fragility model was developed based on Hurricane Ike surveys of almost 2000 individual wood-frame buildings coupled with high resolution hindcast of the hurricane. For this study two states of damage, Collapse and Survival were considered.</p>
<hr class="docutils" />
<p>The input parameters to the fragility model are:</p>
<ol class="simple">
<li><p>Surge: surge level (m) coming from hazard data</p></li>
<li><p>Hs: Significant wave height (m) coming from hazard data</p></li>
<li><p>LHSM: Elevation of the lowest horizontal structural member (ft) coming from building inventory</p></li>
<li><p>age_group: Age group of the building (1, 2,3, and 4 representing age group pre-1974, 19741987, 19871995, and 1995 2008, respectively) coming from building Inventory</p></li>
<li><p>G_elev: Elevation of the building with respect to the ground (m) coming from building inventory</p></li>
</ol>
<hr class="docutils" />
<p>Output:
Pf: probability of failure</p>
<hr class="docutils" />
<p>In order to calculate the probability of failure, first we need to estimate the relative surge height compared to the ground level from:
=ds</p>
<p>Subsequently, we need to calculate the following parameter</p>
<p>=(+0.70.3048)
Note: 0.3048 is to convert ft to m as the inventory data are in ft.</p>
<p>Then:</p>
<p>For FB_hs&gt;= -2.79*Hs the probability of failure is calculated as:
=(3.56+1.521.730.3120.1412)</p>
<p>and for FB_hs&lt; -2.79*Hs
=(3.56+1.52+2.4220.1412)
Where  denotes the Cumulative Density Function (CDF) of standard normal distribution.</p>
<hr class="docutils" />
<p>Example:
If Surge=3 m, Hs =2 m, LHSM=9 ft, age_group=4; G_elev =1 m
Then Pf= 0.2620</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use utility method of pyicore-viz package to visualize the fragility</span>
<span class="n">fragility_set</span> <span class="o">=</span> <span class="n">FragilityCurveSet</span><span class="p">(</span><span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span><span class="o">.</span><span class="n">get_dfr3_set</span><span class="p">(</span><span class="s2">&quot;5f6ccf67de7b566bb71b202d&quot;</span><span class="p">))</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">plotviz</span><span class="o">.</span><span class="n">get_fragility_plot_3d</span><span class="p">(</span><span class="n">fragility_set</span><span class="p">,</span> 
                                            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Galveston empirical fragility model developed &quot;</span>
                                            <span class="s2">&quot;based on Hurricane Ike surveys&quot;</span><span class="p">,</span>
                                            <span class="n">limit_state</span><span class="o">=</span><span class="s2">&quot;LS_0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hazard_type</span> <span class="o">=</span> <span class="s2">&quot;hurricane&quot;</span>
<span class="c1"># Galveston deterministic Hurricane, 3 datasets - Kriging</span>
<span class="n">hazard_id</span> <span class="o">=</span> <span class="s2">&quot;5fa5a228b6429615aeea4410&quot;</span>
<span class="c1"># visualization</span>
<span class="n">wave_height_id</span> <span class="o">=</span> <span class="s2">&quot;5f15cd62c98cf43417c10a3f&quot;</span>
<span class="n">surge_level_id</span> <span class="o">=</span> <span class="s2">&quot;5f15cd5ec98cf43417c10a3b&quot;</span>

<span class="c1"># Hurricane building mapping (with equation)</span>
<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;602c381a1d85547cdc9f0675&quot;</span>
<span class="n">fragility_service</span> <span class="o">=</span> <span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="n">mapping_set</span> <span class="o">=</span> <span class="n">MappingSet</span><span class="p">(</span><span class="n">fragility_service</span><span class="o">.</span><span class="n">get_mapping</span><span class="p">(</span><span class="n">mapping_id</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualize wave height</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">wave_height_id</span><span class="p">,</span> <span class="n">DataService</span><span class="p">(</span><span class="n">client</span><span class="p">))</span>
<span class="nb">map</span> <span class="o">=</span> <span class="n">geoviz</span><span class="o">.</span><span class="n">map_raster_overlay_from_file</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_file_path</span><span class="p">(</span><span class="s1">&#39;tif&#39;</span><span class="p">))</span>
<span class="nb">map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add opacity control - NOTE: It takes time before the opacity takes effect.</span>
<span class="nb">map</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualize surge level</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">surge_level_id</span><span class="p">,</span> <span class="n">DataService</span><span class="p">(</span><span class="n">client</span><span class="p">))</span>
<span class="nb">map</span> <span class="o">=</span> <span class="n">geoviz</span><span class="o">.</span><span class="n">map_raster_overlay_from_file</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_file_path</span><span class="p">(</span><span class="s1">&#39;tif&#39;</span><span class="p">))</span>
<span class="nb">map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add opacity control - NOTE: It takes time before the opacity takes effect.</span>
<span class="nb">map</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>2.2 Building Damage<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_dmg</span> <span class="o">=</span> <span class="n">BuildingDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">bldg_dataset_id</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;dfr3_mapping_set&quot;</span><span class="p">,</span> <span class="n">mapping_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Galveston_bldg_dmg_result&quot;</span>

<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;fragility_key&quot;</span><span class="p">,</span> <span class="s2">&quot;Hurricane SurgeLevel and WaveHeight Fragility ID Code&quot;</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="functionality">
<h1>3) Functionality<a class="headerlink" href="#functionality" title="Permalink to this headline">#</a></h1>
<section id="a-functionality-models">
<h2>3a) Functionality Models<a class="headerlink" href="#a-functionality-models" title="Permalink to this headline">#</a></h2>
<p><img alt="functionality.png" src="notebooks/03_Social_PopulationDislocationAnalysis/attachment:functionality.png" /></p>
</section>
<section id="b-functionality-of-physical-infrastructure">
<h2>3b) Functionality of Physical Infrastructure<a class="headerlink" href="#b-functionality-of-physical-infrastructure" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve result dataset</span>
<span class="n">building_dmg_result</span> <span class="o">=</span> <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;ds_result&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">bdmg_df</span> <span class="o">=</span> <span class="n">building_dmg_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Display top 5 rows of output data</span>
<span class="n">bdmg_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdmg_df</span><span class="o">.</span><span class="n">DS_0</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdmg_df</span><span class="o">.</span><span class="n">DS_3</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-social-science-modules">
<h2>3d) Social Science Modules<a class="headerlink" href="#d-social-science-modules" title="Permalink to this headline">#</a></h2>
<p>Population Dislocation
Population dislocation refers to households that will be forced to leave their pre-event residence due to hazard related damages. Population dislocation is a function of structure value loss due to damage, neighborhood characteristics and structure type.</p>
<section id="d-1-use-new-pyincore-data-utility-to-obtain-block-group-data-for-county">
<h3>3d.1 Use new pyincore-data utility to obtain Block Group Data for County<a class="headerlink" href="#d-1-use-new-pyincore-data-utility-to-obtain-block-group-data-for-county" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore_data.censusutil</span> <span class="kn">import</span> <span class="n">CensusUtil</span>
<span class="n">state_counties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;48167&#39;</span><span class="p">]</span>
<span class="n">blockgroup_df</span><span class="p">,</span> <span class="n">bgmap</span> <span class="o">=</span> <span class="n">CensusUtil</span><span class="o">.</span><span class="n">get_blockgroupdata_for_dislocation</span><span class="p">(</span><span class="n">state_counties</span><span class="p">,</span> 
                                                <span class="n">out_csv</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                <span class="n">out_shapefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                                <span class="n">out_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                <span class="n">program_name</span> <span class="o">=</span> <span class="s2">&quot;BlockGroupData&quot;</span><span class="p">,</span>
                                                <span class="n">geo_name</span> <span class="o">=</span> <span class="s2">&quot;Galveston&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blockgroup_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bg_data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
    <span class="s1">&#39;BlockGroupData/BlockGroupData_Galveston.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;incore:blockGroupData&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-2-population-dislocation">
<h3>3d.2 Population Dislocation<a class="headerlink" href="#d-2-population-dislocation" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_dis</span> <span class="o">=</span> <span class="n">PopulationDislocation</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Value loss parameters DS 0-3</span>
<span class="n">value_loss</span> <span class="o">=</span> <span class="s2">&quot;60354810e379f22e16560dbd&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_dis</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;block_group_data&quot;</span><span class="p">,</span> <span class="n">bg_data</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;value_loss_param&quot;</span><span class="p">,</span> <span class="n">value_loss</span><span class="p">)</span>

<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;building_dmg&quot;</span><span class="p">,</span> <span class="n">building_dmg_result</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;housing_unit_allocation&quot;</span><span class="p">,</span> <span class="n">hua_result</span><span class="p">)</span>

<span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;galveston-pop-disl-results&quot;</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">1111</span>

<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_dis</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-3-explore-population-dislocation-results">
<h3>3.d.3 Explore Population Dislocation Results<a class="headerlink" href="#d-3-explore-population-dislocation-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve result dataset</span>
<span class="n">population_dislocation_result</span> <span class="o">=</span> <span class="n">pop_dis</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>

<span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">pd_df</span> <span class="o">=</span> <span class="n">population_dislocation_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Households&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Tenure Status and Dislocation&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s2">&quot;Tenure Status&quot;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Population Dislocation&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;1 Dislocates&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Households&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Race, Ethnicity and Dislocation&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s2">&quot;Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Population Dislocation&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;1 Dislocates&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add household income group categories for table</span>
<span class="c1"># Code will be added to next release of pop_results_table on pyincore-viz</span>
<span class="k">def</span> <span class="nf">add_label_cat_conditions_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">conditions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Label Categorical Variable Values and add to dataframe.</span>
<span class="sd">    Use this function with values are based on conditions.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        df (obj): Pandas DataFrame object.</span>
<span class="sd">        conditions (dict): Dictionary of conditions for value labels.</span>
<span class="sd">    Returns:</span>
<span class="sd">        object: Pandas DataFrame object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cat_var</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">[</span><span class="s1">&#39;cat_var&#39;</span><span class="p">][</span><span class="s1">&#39;variable_label&#39;</span><span class="p">]</span>

    <span class="n">df</span><span class="p">[</span><span class="n">cat_var</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;No Data&quot;</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">[</span><span class="s1">&#39;condition_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">condition</span> <span class="o">=</span>  <span class="n">conditions</span><span class="p">[</span><span class="s1">&#39;condition_list&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span>
        <span class="n">value_label</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">[</span><span class="s1">&#39;condition_list&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;value_label&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">eval</span><span class="p">(</span><span class="n">condition</span><span class="p">),</span> <span class="n">cat_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_label</span>

    <span class="c1"># Set variable to missing if no data- makes tables look nicer</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">cat_var</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;No Data&quot;</span><span class="p">),</span> 
        <span class="n">cat_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">add_label_cat_values_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">valuelabels</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Label Categorical Variable Values and add to dataframe.</span>
<span class="sd">    Use this function with categorical values </span>
<span class="sd">    are integer values.</span>
<span class="sd">    Args:</span>
<span class="sd">        df (obj): Pandas DataFrame object.</span>
<span class="sd">        valuelabels (dict): Dictionary of value labels.</span>
<span class="sd">        variable (str): Variable to label.</span>
<span class="sd">    Returns:</span>
<span class="sd">        object: Pandas DataFrame object with new column that has value labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">variable</span>  <span class="o">=</span> <span class="n">valuelabels</span><span class="p">[</span><span class="s1">&#39;categorical_variable&#39;</span><span class="p">][</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span>
    <span class="n">variable_label</span> <span class="o">=</span> <span class="n">valuelabels</span><span class="p">[</span><span class="s1">&#39;categorical_variable&#39;</span><span class="p">][</span><span class="s1">&#39;variable_label&#39;</span><span class="p">]</span>

    <span class="n">df</span><span class="p">[</span><span class="n">variable_label</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;No Data&quot;</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">valuelabels</span><span class="p">[</span><span class="s1">&#39;value_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="n">valuelabels</span><span class="p">[</span><span class="s1">&#39;value_list&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">value_label</span> <span class="o">=</span> <span class="n">valuelabels</span><span class="p">[</span><span class="s1">&#39;value_list&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;value_label&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">,</span> <span class="n">variable_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_label</span>

    <span class="c1"># Set variable to missing if no data- makes tables look nicer</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">variable_label</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;No Data&quot;</span><span class="p">),</span> 
        <span class="n">variable_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="n">hhinc_valuelabels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;categorical_variable&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;variable&#39;</span> <span class="p">:</span> <span class="s1">&#39;hhinc&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;variable_label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Household Income Group&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;notes&#39;</span> <span class="p">:</span> <span class="s1">&#39;5 Household Income Groups based on random income.&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;value_list&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="mi">1</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;1 Less than $15,000&quot;</span><span class="p">},</span>
                        <span class="mi">2</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;2 $15,000 to $24,999&quot;</span><span class="p">},</span>
                        <span class="mi">3</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;3 $25,000 to $74,999&quot;</span><span class="p">},</span>
                        <span class="mi">4</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;4 $75,000 to $99,999&quot;</span><span class="p">},</span>
                        <span class="mi">5</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;5 $100,000 or more&quot;</span><span class="p">}}</span>
                    <span class="p">}</span>

<span class="n">pd_df</span> <span class="o">=</span> <span class="n">add_label_cat_values_df</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> <span class="n">valuelabels</span> <span class="o">=</span> <span class="n">hhinc_valuelabels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Households&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Household Income Group and Dislocation&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s2">&quot;Household Income Group&quot;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Population Dislocation&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;1 Dislocates&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-4-explore-population-dislocation-and-building-damage-results">
<h3>3.d.4 Explore Population Dislocation and Building Damage Results<a class="headerlink" href="#d-4-explore-population-dislocation-and-building-damage-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds3_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cat_var&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;variable_label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Probability Complete Failure&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;notes&#39;</span> <span class="p">:</span> <span class="s1">&#39;Probability of complete failure based on damage state 3&#39;</span><span class="p">},</span>
              <span class="s1">&#39;condition_list&#39;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="mi">1</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] == 0)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;0 0%&quot;</span><span class="p">},</span>
                <span class="mi">2</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] &gt; 0)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;1 Less than 20%&quot;</span><span class="p">},</span>
                <span class="mi">3</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] &gt; .2)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;2 20-40%&quot;</span><span class="p">},</span>
                <span class="mi">4</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] &gt; .4)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;3 40-60%&quot;</span><span class="p">},</span>
                <span class="mi">5</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] &gt; .6)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;4 60-80%&quot;</span><span class="p">},</span>
                <span class="mi">6</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] &gt; .8)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;5 80-100%&quot;</span><span class="p">},</span>
                <span class="mi">7</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s2">&quot;(df[&#39;DS_3&#39;] == 1)&quot;</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;6 100%&quot;</span><span class="p">}}</span>
            <span class="p">}</span>

      
<span class="n">dsf_valuelabels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;categorical_variable&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;variable&#39;</span> <span class="p">:</span> <span class="s1">&#39;d_sf&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;variable_label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Single Family Dwelling&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;notes&#39;</span> <span class="p">:</span> <span class="s1">&#39;Categories for single family dwellings&#39;</span><span class="p">},</span>
              <span class="s1">&#39;value_list&#39;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="mi">1</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;0 Not Single Family&quot;</span><span class="p">},</span>
                <span class="mi">2</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;1 Single Family&quot;</span><span class="p">}}</span>
            <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_df</span> <span class="o">=</span> <span class="n">add_label_cat_conditions_df</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">ds3_conditions</span><span class="p">)</span>
<span class="n">pd_df</span> <span class="o">=</span> <span class="n">add_label_cat_values_df</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> <span class="n">valuelabels</span> <span class="o">=</span> <span class="n">dsf_valuelabels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Households&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Probability of Complete Failure and Dislocation&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Probability Complete Failure&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Population Dislocation&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;1 Dislocates&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd_df</span><span class="p">[</span><span class="s1">&#39;DS_3&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">.8</span><span class="p">)],</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Households&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;for High Damaged Structures by Single Family Dwelling&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Single Family Dwelling&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Population Dislocation&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;0 Does not dislocate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd_df</span><span class="p">[</span><span class="s1">&#39;DS_3&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">.8</span><span class="p">)],</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Households&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;for High Damaged Structures by Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Race Ethnicity&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Population Dislocation&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;0 Does not dislocate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="recovery">
<h1>4) Recovery<a class="headerlink" href="#recovery" title="Permalink to this headline">#</a></h1>
<p><img alt="Recovery.png" src="notebooks/03_Social_PopulationDislocationAnalysis/attachment:Recovery.png" /></p>
<ul class="simple">
<li><p><strong>j</strong> is the index for time</p></li>
<li><p><strong>m</strong> is the community lifetime</p></li>
<li><p><strong>K</strong> is the index for policy levers and decision combinations (PD)</p></li>
</ul>
<section id="household-level-housing-recovery-analysis">
<h2>4.1 Household-Level Housing Recovery Analysis<a class="headerlink" href="#household-level-housing-recovery-analysis" title="Permalink to this headline">#</a></h2>
<p>The Household-Level Housing Recovery (HHHR) model developed by Sutley and Hamideh (2020) is used to simulate the housing recovery process of dislocated households.</p>
<p>The computation operates by segregating household units into five zones as a way of assigning social vulnerability. Then, using this vulnerability in conjunction with the Transition Probability Matrix (TPM) and the initial state vector, a Markov chain computation simulates the most probable states to generate a stage history of housing recovery changes for each household. The detailed process of the HHHR model can be found in Sutley and Hamideh (2020).</p>
<blockquote>
<div><p>Sutley, E.J. and Hamideh, S., 2020. Postdisaster housing stages: a Markov chain approach to model sequences and duration based on social vulnerability. Risk Analysis, 40(12), pp.2675-2695.</p>
</div></blockquote>
<p>The Markov chain model consists of five discrete states at any time throughout the housing recovery process. The five discrete states represent stages in the household housing recovery process, including emergency shelter (1), temporary shelter (2); temporary housing (3); permanent housing (4), and failure to recover (5). The model assumes that a household can be in any of the first four stages immediately after a disaster. If the household reported not being dislocated, household will begin in stage 4.</p>
</section>
<section id="set-up-and-run-household-level-housing-sequential-recovery">
<h2>4.2 Set Up and Run Household-level Housing Sequential Recovery<a class="headerlink" href="#set-up-and-run-household-level-housing-sequential-recovery" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transition probability matrix per social vulnerability level, from Sutley and Hamideh (2020).</span>
<span class="n">transition_probability_matrix</span> <span class="o">=</span> <span class="s2">&quot;60f5e2ae544e944c3cec0794&quot;</span>
<span class="c1"># Initial mass probability function for household at time 0</span>
<span class="n">initial_probability_vector</span> <span class="o">=</span> <span class="s2">&quot;60f5e918544e944c3cec668b&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="population-dislocation-results-error">
<h2>Population Dislocation results error<a class="headerlink" href="#population-dislocation-results-error" title="Permalink to this headline">#</a></h2>
<p>the blockid is too big to make a int first - need to either use int64 of convert to int64 first before converting to int</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create housing recovery instance</span>
<span class="n">housing_recovery</span> <span class="o">=</span> <span class="n">HousingRecoverySequential</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="c1"># Load input datasets from dislocation, tpm, and initial probability function</span>
<span class="c1">#housing_recovery.load_remote_input_dataset(&quot;population_dislocation_block&quot;, population_dislocation)</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;population_dislocation_block&quot;</span><span class="p">,</span> <span class="n">population_dislocation_result</span><span class="p">)</span>

<span class="n">housing_recovery</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;tpm&quot;</span><span class="p">,</span> <span class="n">transition_probability_matrix</span><span class="p">)</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;initial_stage_probabilities&quot;</span><span class="p">,</span> <span class="n">initial_probability_vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial value to seed the random number generator to ensure replication</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="c1"># A size of the analysis time step in month</span>
<span class="n">t_delta</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Total duration of Markov chain recovery process</span>
<span class="n">t_final</span> <span class="o">=</span> <span class="mf">90.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the result name</span>
<span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;housing_recovery_result&quot;</span>

<span class="c1"># Set analysis parameters</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;t_delta&quot;</span><span class="p">,</span> <span class="n">t_delta</span><span class="p">)</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;t_final&quot;</span><span class="p">,</span> <span class="n">t_final</span><span class="p">)</span>

<span class="c1"># Run the household recovery sequence analysis - Markov model</span>
<span class="n">housing_recovery</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-sufficient-quality-solutions-found">
<h2>6 a) Sufficient Quality Solutions Found?<a class="headerlink" href="#a-sufficient-quality-solutions-found" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve result dataset</span>
<span class="n">housing_recovery_result</span> <span class="o">=</span> <span class="n">housing_recovery</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;ds_result&quot;</span><span class="p">)</span>

<span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">df_hhrs</span> <span class="o">=</span> <span class="n">housing_recovery_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>

<span class="c1"># Display top 5 rows of output data</span>
<span class="n">df_hhrs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Plot Housing Recovery Sequence Results</p>
</div></blockquote>
<blockquote>
<div><p>view recovery sequence results for specific households</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">df_hhrs</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="s1">&#39;huid&#39;</span><span class="p">,</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;SV&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">t_final</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Plot stage histories and stage changes using pandas.</span>
<span class="c1"># Generate timestep labels for dataframes.</span>
<span class="n">label_timestep</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i4</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_final</span><span class="p">):</span>
    <span class="n">label_timestep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i4</span><span class="p">))</span>
    
<span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span><span class="mi">48</span><span class="p">]</span> <span class="c1"># select specific household by id numbers</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
    <span class="n">HH_stagehistory_DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="nb">id</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]),</span>
                                      <span class="n">index</span><span class="o">=</span><span class="n">label_timestep</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">HH_stagehistory_DF</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
                                               <span class="n">yticks</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                                               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Household Recovery Sequences&#39;</span><span class="p">,</span>
                                               <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Timestep (months)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Stage&#39;</span><span class="p">)</span>
    <span class="n">y_ticks_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y_ticks_labels</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Plot recovery heatmap any stage of recovery</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hhrs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># merge household unit information with recovery results</span>
<span class="n">pd_df_hs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">pd_df</span><span class="p">,</span> 
                    <span class="n">right</span> <span class="o">=</span> <span class="n">df_hhrs</span><span class="p">,</span>
                    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">],</span>
                    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_df_hs</span><span class="p">[[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recovery_data</span> <span class="o">=</span> <span class="n">pd_df_hs</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;numprec&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd_df_hs</span><span class="p">[</span><span class="s1">&#39;85&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">recovery_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Plot recovery heatmap after 12 months of recovery</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipyleaflet</span> <span class="kn">import</span> <span class="n">Map</span><span class="p">,</span> <span class="n">Heatmap</span><span class="p">,</span> <span class="n">LayersControl</span><span class="p">,</span> <span class="n">LegendControl</span>

<span class="c1"># What location should the map be centered on?</span>
<span class="n">center_x</span> <span class="o">=</span> <span class="n">pd_df_hs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">center_y</span> <span class="o">=</span> <span class="n">pd_df_hs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">map</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="n">center_y</span><span class="p">,</span> <span class="n">center_x</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">stage5_data</span> <span class="o">=</span> <span class="n">pd_df_hs</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;numprec&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd_df_hs</span><span class="p">[</span><span class="s1">&#39;85&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">stage5</span> <span class="o">=</span> <span class="n">Heatmap</span><span class="p">(</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="n">stage5_data</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> 
    <span class="n">blur</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
    <span class="n">gradient</span><span class="o">=</span><span class="p">{</span><span class="mf">0.2</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Stage 5 - Failure to Recover&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">stage4_data</span> <span class="o">=</span> <span class="n">pd_df_hs</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;numprec&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd_df_hs</span><span class="p">[</span><span class="s1">&#39;85&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">stage4</span> <span class="o">=</span> <span class="n">Heatmap</span><span class="p">(</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="n">stage4_data</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> 
    <span class="n">blur</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
    <span class="n">gradient</span><span class="o">=</span><span class="p">{</span><span class="mf">0.2</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">},</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Stage 4 - Permanent Housing&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">map</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">stage4</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">stage5</span><span class="p">)</span>


<span class="n">control</span> <span class="o">=</span> <span class="n">LayersControl</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s1">&#39;topright&#39;</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
<span class="nb">map</span>
</pre></div>
</div>
</div>
</div>
<p>The five discrete states represent stages in the household housing recovery process, including emergency shelter (1), temporary shelter (2); temporary housing (3); permanent housing (4), and failure to recover (5). The model assumes that a household can be in any of the first four stages immediately after a disaster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hhrs_valuelabels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;categorical_variable&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;variable&#39;</span> <span class="p">:</span> <span class="s1">&#39;select time step&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;variable_label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Household housing recovery stages&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;notes&#39;</span> <span class="p">:</span> <span class="s1">&#39;Sutley and Hamideh recovery stages&#39;</span><span class="p">},</span>
              <span class="s1">&#39;value_list&#39;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="mi">1</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;1 Emergency Shelter&quot;</span><span class="p">},</span>
                <span class="mi">2</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;2 Temporary Shelter&quot;</span><span class="p">},</span>
                <span class="mi">3</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;3 Temporary Housing&quot;</span><span class="p">},</span>
                <span class="mi">4</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;4 Permanent Housing&quot;</span><span class="p">},</span>
                <span class="mi">5</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;5 Failure to Recover&quot;</span><span class="p">}}</span>
            <span class="p">}</span>

<span class="n">permanenthousing_valuelabels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;categorical_variable&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;variable&#39;</span> <span class="p">:</span> <span class="s1">&#39;select time step&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;variable_label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Permanent Housing&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;notes&#39;</span> <span class="p">:</span> <span class="s1">&#39;Sutley and Hamideh recovery stages&#39;</span><span class="p">},</span>
              <span class="s1">&#39;value_list&#39;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="mi">1</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;0 Not Permanent Housing&quot;</span><span class="p">},</span>
                <span class="mi">2</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;0 Not Permanent Housing&quot;</span><span class="p">},</span>
                <span class="mi">3</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;0 Not Permanent Housing&quot;</span><span class="p">},</span>
                <span class="mi">4</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;1 Permanent Housing&quot;</span><span class="p">},</span>
                <span class="mi">5</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;value_label&#39;</span><span class="p">:</span> <span class="s2">&quot;0 Not Permanent Housing&quot;</span><span class="p">}}</span>
            <span class="p">}</span>

<span class="n">pd_df_hs</span> <span class="o">=</span> <span class="n">add_label_cat_values_df</span><span class="p">(</span><span class="n">pd_df_hs</span><span class="p">,</span> <span class="n">valuelabels</span> <span class="o">=</span> <span class="n">hhrs_valuelabels</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;13&#39;</span><span class="p">)</span>
<span class="n">pd_df_hs</span> <span class="o">=</span> <span class="n">add_label_cat_values_df</span><span class="p">(</span><span class="n">pd_df_hs</span><span class="p">,</span> <span class="n">valuelabels</span> <span class="o">=</span> <span class="n">permanenthousing_valuelabels</span><span class="p">,</span>
                        <span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;13&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df_hs</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Householder&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Housing Type at T=13 by Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Race Ethnicity&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Household housing recovery stages&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;2 Temporary Shelter&#39;</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df_hs</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Householder&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Permanent Housing at T=13 by Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Race Ethnicity&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Permanent Housing&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s2">&quot;0 Not Permanent Housing&quot;</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-policy-lever-and-decision-combinations">
<h2>8b) Policy Lever and Decision Combinations<a class="headerlink" href="#b-policy-lever-and-decision-combinations" title="Permalink to this headline">#</a></h2>
<p>Hypothetical scenario to elevate all buildings in inventory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_gdf_policy2</span> <span class="o">=</span> <span class="n">bldg_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">18</span><span class="p">):</span> 
    
    <span class="c1">################## 1a) updated building inventory ##################  </span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running Analysis: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">bldg_gdf_policy2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bldg_gdf_policy2</span><span class="p">[</span><span class="s1">&#39;lhsm_elev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="s1">&#39;lhsm_elev&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">bldg_gdf_policy2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;input_df_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">)</span>
    <span class="c1"># Save new shapefile and then use as new input to building damage model</span>
    <span class="n">bldg_gdf_policy2</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">driver</span> <span class="o">=</span> <span class="s1">&#39;ESRI Shapefile&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;bldg_gdf_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.shp&#39;</span><span class="p">)</span>
    <span class="c1"># Plot and save</span>
    <span class="n">geoviz</span><span class="o">.</span><span class="n">plot_gdf_map</span><span class="p">(</span><span class="n">bldg_gdf_policy2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;lhsm_elev&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
    <span class="c1"># Code to save the results here</span>
    <span class="c1">####################################################################      </span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">################## 2c) Damage to Physical Infrastructure ##################  </span>
    <span class="n">building_inv_policy2</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;bldg_gdf_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.shp&#39;</span><span class="p">,</span>
                                        <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ergo:buildingInventoryVer7&#39;</span><span class="p">)</span>

    <span class="n">bldg_dmg</span> <span class="o">=</span> <span class="n">BuildingDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
    <span class="c1">#bldg_dmg.load_remote_input_dataset(&quot;buildings&quot;, bldg_dataset_id)</span>
    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">building_inv_policy2</span><span class="p">)</span>
    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;dfr3_mapping_set&quot;</span><span class="p">,</span> <span class="n">mapping_set</span><span class="p">)</span>

    <span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Galveston_bldg_dmg_result&quot;</span>

    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;fragility_key&quot;</span><span class="p">,</span> <span class="s2">&quot;Hurricane SurgeLevel and WaveHeight Fragility ID Code&quot;</span><span class="p">)</span>
    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
    <span class="c1">###########################################################################</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">################## 3b) Functionality of Physical Infrastructure ##################</span>
    <span class="c1"># Retrieve result dataset</span>
    <span class="n">building_dmg_result_policy2</span> <span class="o">=</span> <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;ds_result&#39;</span><span class="p">)</span>
    <span class="c1"># Convert dataset to Pandas DataFrame</span>
    <span class="n">bdmg_policy2_df</span> <span class="o">=</span> <span class="n">building_dmg_result_policy2</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Save CSV files for post processing</span>
    <span class="n">bdmg_policy2_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bld_damage_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
    <span class="c1">##################################################################################</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">############################  3d) Social Science Modules ############################   </span>
    <span class="c1"># update building damage</span>
    <span class="n">pop_dis</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;building_dmg&quot;</span><span class="p">,</span> <span class="n">building_dmg_result_policy2</span><span class="p">)</span>

    <span class="c1"># Update file name for saving results</span>
    <span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;galveston-pop-disl-results_policy2&quot;</span>
    <span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
    
    <span class="n">pop_dis</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
    
    <span class="c1"># Retrieve result dataset</span>
    <span class="n">population_dislocation_result_policy2</span> <span class="o">=</span> <span class="n">pop_dis</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>

    <span class="c1"># Convert dataset to Pandas DataFrame</span>
    <span class="n">pd_df_policy2</span> <span class="o">=</span> <span class="n">population_dislocation_result_policy2</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Save CSV files for post processing</span>
    <span class="n">pd_df_policy2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pd_df_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
    <span class="c1">######################################################################################</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">############################  4) Recovery ############################   </span>
    <span class="c1"># Update population dislocation</span>
    <span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;population_dislocation_block&quot;</span><span class="p">,</span> 
                            <span class="n">population_dislocation_result_policy2</span><span class="p">)</span>
    <span class="c1"># Update file name for saving results</span>
    <span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;housing_recovery_result_policy2&quot;</span>
    <span class="c1"># Set analysis parameters</span>
    <span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
    <span class="n">housing_recovery</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
    
    <span class="c1"># Run the household recovery sequence analysis - Markov model</span>
    <span class="n">housing_recovery</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    
    <span class="c1"># Retrieve result dataset</span>
    <span class="n">housing_recovery_result_policy2</span> <span class="o">=</span> <span class="n">housing_recovery</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;ds_result&quot;</span><span class="p">)</span>

    <span class="c1"># Convert dataset to Pandas DataFrame</span>
    <span class="n">df_hhrs_policy2</span> <span class="o">=</span> <span class="n">housing_recovery_result_policy2</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
    <span class="c1"># Save CSV files for post processing</span>
    <span class="n">df_hhrs_policy2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;df_hhrs_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="post-processing">
<h1>POST PROCESSING<a class="headerlink" href="#post-processing" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># choose i between 1 to 17</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<section id="postprocessing-functionality-of-physical-infrastructure">
<h2>Postprocessing: Functionality of Physical Infrastructure<a class="headerlink" href="#postprocessing-functionality-of-physical-infrastructure" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdmg_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="s1">&#39;bld_damage_results_policy_0.csv&#39;</span><span class="p">)</span>
<span class="n">bdmg_policy2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bld_damage_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>

<span class="sa">f</span><span class="s1">&#39;bldg_gdf_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.shp&#39;</span>
<span class="c1"># Merge policy i with policy j</span>
<span class="n">bdmg_df_policies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">bdmg_df</span><span class="p">,</span>
                      <span class="n">right</span> <span class="o">=</span> <span class="n">bdmg_policy2_df</span><span class="p">,</span>
                      <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;guid&#39;</span><span class="p">,</span>
                      <span class="n">suffixes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_policy0&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_policy</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">bdmg_df_policies</span><span class="p">[[</span><span class="s1">&#39;DS_0_policy0&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;DS_0_policy</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdmg_df_policies</span><span class="p">[[</span><span class="s1">&#39;DS_3_policy0&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;DS_3_policy</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Scatter Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bdmg_df_policies</span><span class="p">[</span><span class="s1">&#39;DS_3_policy0&#39;</span><span class="p">],</span> <span class="n">bdmg_df_policies</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;DS_3_policy</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scatter plot Policy 0 vs Policy </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Complete Damage Policy 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Complete Damage Policy </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CompleteDamage</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.tif&#39;</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdmg_df_policies</span><span class="p">[</span><span class="s1">&#39;DS_3_policy0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="postprocessing-social-science-modules">
<h2>Postprocessing: Social Science Modules<a class="headerlink" href="#postprocessing-social-science-modules" title="Permalink to this headline">#</a></h2>
</section>
<section id="postprocessing-recovery">
<h2>Postprocessing: Recovery<a class="headerlink" href="#postprocessing-recovery" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hhrs_policy2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;df_hhrs_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
<span class="c1"># merge household unit information with recovery results</span>
<span class="n">pd_df_hs_policy2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">pd_df_policy2</span><span class="p">,</span> 
                    <span class="n">right</span> <span class="o">=</span> <span class="n">df_hhrs_policy2</span><span class="p">,</span>
                    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">],</span>
                    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">pd_df_hs_policy2</span><span class="p">[[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>6a) Sufficient Quality Solutions Found?<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_df_policy2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;pd_df_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">)</span>
<span class="n">df_hhrs_policy2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;df_hhrs_results_policy_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">)</span>

<span class="n">pd_df_hs_policy2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">pd_df_policy2</span><span class="p">,</span> 
                    <span class="n">right</span> <span class="o">=</span> <span class="n">df_hhrs_policy2</span><span class="p">,</span>
                    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span><span class="s1">&#39;huid&#39;</span><span class="p">],</span>
                    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add HHRS categories to dataframe</span>
<span class="n">pd_df_hs_policy2</span> <span class="o">=</span> <span class="n">add_label_cat_values_df</span><span class="p">(</span><span class="n">pd_df_hs_policy2</span><span class="p">,</span> 
            <span class="n">valuelabels</span> <span class="o">=</span> <span class="n">hhrs_valuelabels</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;13&#39;</span><span class="p">)</span>
<span class="n">pd_df_hs_policy2</span> <span class="o">=</span> <span class="n">add_label_cat_values_df</span><span class="p">(</span><span class="n">pd_df_hs_policy2</span><span class="p">,</span> 
            <span class="n">valuelabels</span> <span class="o">=</span> <span class="n">permanenthousing_valuelabels</span><span class="p">,</span>
                        <span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;13&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df_hs_policy2</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Householder&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Permanent Housing at T=13 by Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010 - Policy 2 - All buildings elvated&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Race Ethnicity&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Permanent Housing&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;0 Not Permanent Housing&#39;</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poptable</span><span class="o">.</span><span class="n">pop_results_table</span><span class="p">(</span><span class="n">pd_df_hs</span><span class="p">,</span> 
                  <span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Total Population by Householder&quot;</span><span class="p">,</span> 
                  <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;by Permanent Housing at T=13 by Race Ethnicity&quot;</span><span class="p">,</span>
                  <span class="n">where</span> <span class="o">=</span> <span class="s2">&quot;Galveston Island TX&quot;</span><span class="p">,</span>
                  <span class="n">when</span> <span class="o">=</span> <span class="s2">&quot;2010 - Baseline&quot;</span><span class="p">,</span>
                  <span class="n">row_index</span> <span class="o">=</span> <span class="s1">&#39;Race Ethnicity&#39;</span><span class="p">,</span>
                  <span class="n">col_index</span> <span class="o">=</span> <span class="s1">&#39;Permanent Housing&#39;</span><span class="p">,</span>
                  <span class="n">row_percent</span> <span class="o">=</span> <span class="s1">&#39;0 Not Permanent Housing&#39;</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_gdf_map</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">basemap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">OpenStreetMap</span><span class="o">.</span><span class="n">Mapnik</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot Geopandas DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            gdf (obj): Geopandas DataFrame object.</span>
<span class="sd">            column (str): A column name to be plot.</span>
<span class="sd">            category (bool): Turn on/off category option.</span>
<span class="sd">            basemap (bool): Turn on/off base map (e.g. openstreetmap).</span>
<span class="sd">            source(obj): source of the Map to be used. examples, ctx.providers.OpenStreetMap.Mapnik (default),</span>
<span class="sd">                ctx.providers.Stamen.Terrain, ctx.providers.CartoDB.Positron etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> 
                      <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="n">category</span><span class="p">)</span> 

        <span class="k">if</span> <span class="n">basemap</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bld_damage_results_policy_0_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;bld_damage_results_policy_0.csv&#39;</span><span class="p">)</span>
<span class="n">bld_damage_results_policy_0_df</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s1">&#39;epsg:4326&#39;</span>
<span class="n">bld_damage_results_policy_0_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bldg_gdf_policy2</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
<span class="n">plot_gdf_map</span><span class="p">(</span><span class="n">bld_damage_results_policy_0_df</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;DS_3&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bld_damage_results_policy_4_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;bld_damage_results_policy_4.csv&#39;</span><span class="p">)</span>
<span class="n">bld_damage_results_policy_4_df</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s1">&#39;epsg:4326&#39;</span>
<span class="n">bld_damage_results_policy_4_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bldg_gdf_policy2</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
<span class="n">plot_gdf_map</span><span class="p">(</span><span class="n">bld_damage_results_policy_4_df</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;DS_3&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Yes - elevating all buildings in the inventory to 17 feet reduces dislocation from 20.6% to 0.2% and increases the population in permanent housing at t=13 from 42,353 to 45,405.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bld_damage_results_policy_17_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;bld_damage_results_policy_17.csv&#39;</span><span class="p">)</span>
<span class="n">bld_damage_results_policy_17_df</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s1">&#39;epsg:4326&#39;</span>
<span class="n">bld_damage_results_policy_17_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bldg_gdf_policy2</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PF</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bld_damage_results_policy_17_df</span><span class="p">[</span><span class="s1">&#39;DS_3&#39;</span><span class="p">])</span>
<span class="c1"># gdf = gpd.read_file(&#39;Galveston Building Inventory ShapeFile/Building.shp&#39;)</span>
<span class="c1"># gdf = gdf.to_crs(epsg=3857)  # To fix the error you may try this in command window: pip uninstall pyproj and pip install pyproj</span>
<span class="c1"># # np.size(gdf,0)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">bldg_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">PF</span><span class="p">,</span><span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># print(gdf)</span>
<span class="c1"># print(&#39;Household inventory probability of damage&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;Galveston Building Inventory ShapeFile/Building.shp&#39;</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>  <span class="c1"># To fix the error you may try this in command window: pip uninstall pyproj and pip install pyproj</span>
<span class="c1"># # np.size(gdf,0)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">PF_household</span><span class="p">,</span><span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># print(gdf)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Household inventory probability of damage&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_dataset_id</span> <span class="o">=</span> <span class="s2">&quot;60354b6c123b4036e6837ef7&quot;</span>               <span class="c1"># defining building dataset (GIS point layer)       </span>
<span class="n">bldg_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">bldg_dataset_id</span><span class="p">,</span> <span class="n">data_service</span><span class="p">)</span>
<span class="n">geoviz</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">bldg_dataset</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;age_group&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Galveston testbed building inventory as a function of age group&#39;</span><span class="p">)</span>

<span class="n">bldg_df</span> <span class="o">=</span> <span class="n">bldg_dataset</span><span class="o">.</span><span class="n">get_dataframe_from_shapefile</span><span class="p">()</span>
<span class="c1">#bldg_df.set_index(&#39;guid&#39;, inplace=True)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of buildings: </span><span class="si">{}</span><span class="s1">&#39;</span> <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bldg_df</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PF</span><span class="o">=</span><span class="n">bld_damage_results_policy_17_df</span><span class="p">[</span><span class="s1">&#39;DS_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PF</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_name</span><span class="p">[</span><span class="n">PF</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "npr99/IN-CORE_Galveston",
            ref: "kooshan_main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks\03_Social_PopulationDislocationAnalysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../01_Damage_Transportation_Roadways/RoadwaysDamage_05_18_22.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Galveston Island Damage Model: Roadways</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Kooshan Amini<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>